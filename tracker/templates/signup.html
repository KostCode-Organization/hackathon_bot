{% load static %}
{% load socialaccount %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sign Up</title>
    <link rel="stylesheet" href="{% static 'admin/css/base.css' %}">
    <link rel="stylesheet" href="{% static 'admin/css/dark_mode.css' %}">
    <script src="{% static 'admin/js/theme.js' %}"></script>
    <link rel="stylesheet" href="{% static 'admin/css/nav_sidebar.css' %}">
    <script src="{% static 'admin/js/nav_sidebar.js' %}" defer></script>
    <link rel="stylesheet" href="{% static 'admin/css/login.css' %}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'admin/css/responsive.css' %}">
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const roleSelect = document.querySelector('#id_role');
            const githubText = document.querySelector('#github-text');
            const submitButton = document.querySelector('.submit-row input[type="submit"]');
            const signupForm = document.querySelector('#signup-form');
            const loginTechLead = document.querySelector('#tech-lead-login');
            const githubSection = document.querySelector('#github-section');
            const formSection = document.querySelector('#form-section');
            const techLeadLoginLink = document.querySelector('#tech-lead-login-link');

            function updateRoleText() {
                const role = roleSelect.value;
                if (role === 'contributor') {
                    // Show GitHub login only for Contributor
                    githubSection.style.display = 'block';
                    formSection.style.display = 'none';
                    signupForm.style.display = 'none';
                    techLeadLoginLink.style.display = 'none'; // Hide Tech Lead login
                    submitButton.value = 'Sign Up as Contributor';
                } else if (role === 'tech-lead') {
                    // Show Tech Lead login/sign up form
                    githubSection.style.display = 'none';
                    formSection.style.display = 'block';
                    signupForm.style.display = 'block';
                    techLeadLoginLink.style.display = 'block'; // Show Tech Lead login link
                    submitButton.value = 'Sign Up as Tech Lead';
                }
            }

            // Initialize text and section visibility based on the default value
            updateRoleText();

            // Update text and section visibility on role change
            roleSelect.addEventListener('change', updateRoleText);
        });

    </script>
</head>
<body class="login">
{% if messages %}
<ul class="errorlist">
    {% for message in messages %}
    <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<div id="container">
    <header id="header">
        <div id="branding">
            <div id="site-name">
                <a href="/">Sign Up</a>
            </div>
            <button class="theme-toggle">
                <span class="visually-hidden theme-label-when-auto">Toggle theme (current theme: auto)</span>
                <span class="visually-hidden theme-label-when-light">Toggle theme (current theme: light)</span>
                <span class="visually-hidden theme-label-when-dark">Toggle theme (current theme: dark)</span>
                <svg aria-hidden="true" class="theme-icon-when-auto">
                    <use xlink:href="#icon-auto"/>
                </svg>
                <svg aria-hidden="true" class="theme-icon-when-dark">
                    <use xlink:href="#icon-moon"/>
                </svg>
                <svg aria-hidden="true" class="theme-icon-when-light">
                    <use xlink:href="#icon-sun"/>
                </svg>
            </button>
        </div>
    </header>

    <div id="main" class="main">
        <main id="content-start" class="content" tabindex="-1">
            <div id="content" class="colM">
                <div id="content-main">
                    <!-- Role Selection -->
                    <div class="form-row">
                        <label for="id_role" class="required">Role:</label>
                        <select id="id_role" name="role">
                            <option value="contributor">Contributor</option>
                            <option value="tech-lead">Tech Lead</option>
                        </select>
                    </div>

                    <!-- GitHub Login Section for Contributor -->
                    <div id="github-section" style="display: none; text-align: center;">
                        <p>Sign in with GitHub:</p>
                        <a href="{% provider_login_url 'github' %}" style="display: inline-block;">
                            <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"
                                 alt="Sign in with GitHub"
                                 style="width: 40px; height: 40px; vertical-align: middle;">
                        </a>
                    </div>

                    <!-- Tech Lead Sign Up / Login Form -->
                    <div id="form-section" style="display: none;">
                        <form method="post" id="signup-form">
                            {% csrf_token %}
                            <div class="form-row">
                                <label for="id_username" class="required">Email:</label>
                                <input type="email" name="email" autocapitalize="none" required id="id_username">
                            </div>
                            <div class="form-row">
                                <label for="id_password" class="required">Password:</label>
                                <input type="password" name="password" required id="id_password">
                            </div>
                            <div class="form-row">
                                <label for="id_confirm_password" class="required">Confirm password:</label>
                                <input type="password" name="confirm_password" required id="id_password">
                            </div>
                            <div class="submit-row">
                                <input type="submit" value="Sign Up as Tech Lead">
                            </div>
                        </form>

                        <!-- Login Link for Tech Lead -->
                        <div id="tech-lead-login-link" style="display: none;">
                            <p>Already a Tech Lead? <a href="/admin/">Log in as Tech Lead</a></p>
                        </div>
                    </div>
                </div>
                <br class="clear">
            </div>
        </main>
    </div>
    <footer id="footer"></footer>
</div>
</body>
</html>
